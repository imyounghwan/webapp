#!/usr/bin/env python3
"""
Nielsen 10ì›ì¹™ ê¸°ë°˜ 25ê°œ ì„¸ë¶€ í•­ëª© UI/UX ë¶„ì„ê¸°
ì œì´ì½¥ ë‹ìŠ¨ì˜ ì‚¬ìš©ì„± ì›ì¹™ì— ë”°ë¼ ìƒì„¸ ì§„ë‹¨ ë° ê°œì„  ë°©ì•ˆ ìƒì„±
"""

import json
import pandas as pd
from pathlib import Path
from typing import Dict, List, Tuple

class NielsenAnalyzer:
    """Nielsen 10ê°€ì§€ ì›ì¹™ ê¸°ë°˜ ìƒì„¸ UI/UX ë¶„ì„"""
    
    def __init__(self, data_dir: str = "data"):
        self.data_dir = Path(data_dir)
        self.output_dir = Path("output")
        self.output_dir.mkdir(exist_ok=True)
        
        # Nielsen 10ì›ì¹™ â†’ 25ê°œ ì„¸ë¶€ í•­ëª© ë§¤í•‘
        self.nielsen_criteria = {
            "N1_visibility": {
                "name": "ì‹œìŠ¤í…œ ìƒíƒœ ê°€ì‹œì„±",
                "weight": 0.10,
                "items": {
                    "N1.1": "í˜„ì¬ í˜ì´ì§€ ìœ„ì¹˜ í‘œì‹œ",
                    "N1.2": "ë¡œë”© ìƒíƒœ í‘œì‹œ",
                    "N1.3": "ì‘ì—… ì™„ë£Œ í”¼ë“œë°±"
                }
            },
            "N2_real_world": {
                "name": "ì‹œìŠ¤í…œê³¼ í˜„ì‹¤ì˜ ì¼ì¹˜",
                "weight": 0.12,
                "items": {
                    "N2.1": "ì‚¬ìš©ì ì¹œí™”ì  ìš©ì–´",
                    "N2.2": "ë…¼ë¦¬ì  ì •ë³´ êµ¬ì¡°",
                    "N2.3": "ì¹œìˆ™í•œ ì•„ì´ì½˜"
                }
            },
            "N3_control": {
                "name": "ì‚¬ìš©ì ì œì–´ ë° ììœ ë„",
                "weight": 0.11,
                "items": {
                    "N3.1": "ë’¤ë¡œê°€ê¸°/ì·¨ì†Œ ê¸°ëŠ¥",
                    "N3.2": "ì„ì‹œ ì €ì¥ ê¸°ëŠ¥",
                    "N3.3": "ë°ì´í„° ê´€ë¦¬ ê¸°ëŠ¥"
                }
            },
            "N4_consistency": {
                "name": "ì¼ê´€ì„± ë° í‘œì¤€",
                "weight": 0.10,
                "items": {
                    "N4.1": "ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì¼ê´€ì„±",
                    "N4.2": "ìƒ‰ìƒ ì²´ê³„ ì¼ê´€ì„±",
                    "N4.3": "íƒ€ì´í¬ê·¸ë˜í”¼ ì¼ê´€ì„±"
                }
            },
            "N5_prevention": {
                "name": "ì˜¤ë¥˜ ì˜ˆë°©",
                "weight": 0.12,
                "items": {
                    "N5.1": "ì…ë ¥ í˜•ì‹ ê°€ì´ë“œ",
                    "N5.2": "ì‹¤ì‹œê°„ ìœ íš¨ì„± ê²€ì‚¬",
                    "N5.3": "ì¤‘ìš” ì‘ì—… í™•ì¸"
                }
            },
            "N6_recognition": {
                "name": "ê¸°ì–µë³´ë‹¤ ì¸ì‹",
                "weight": 0.10,
                "items": {
                    "N6.1": "ìµœê·¼ ê²€ìƒ‰ì–´ í‘œì‹œ",
                    "N6.2": "ìë™ì™„ì„± ê¸°ëŠ¥",
                    "N6.3": "ì‹œê°ì  íŒíŠ¸"
                }
            },
            "N7_flexibility": {
                "name": "ìœ ì—°ì„± ë° íš¨ìœ¨ì„±",
                "weight": 0.08,
                "items": {
                    "N7.1": "ë‹¨ì¶•í‚¤ ì œê³µ",
                    "N7.2": "ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥",
                    "N7.3": "ê³ ê¸‰ ê²€ìƒ‰ ì˜µì…˜"
                }
            },
            "N8_minimalist": {
                "name": "ë¯¸ë‹ˆë©€í•œ ë””ìì¸",
                "weight": 0.10,
                "items": {
                    "N8.1": "ì •ë³´ ë°€ë„ ì ì •ì„±",
                    "N8.2": "ì—¬ë°± í™œìš©",
                    "N8.3": "ì‹œê°ì  ê³„ì¸µ êµ¬ì¡°"
                }
            },
            "N9_error_recovery": {
                "name": "ì˜¤ë¥˜ ë³µêµ¬ ì§€ì›",
                "weight": 0.12,
                "items": {
                    "N9.1": "ëª…í™•í•œ ì˜¤ë¥˜ ë©”ì‹œì§€",
                    "N9.2": "í•´ê²° ë°©ë²• ì œì‹œ",
                    "N9.3": "ì˜¤ë¥˜ ìœ„ì¹˜ í‘œì‹œ"
                }
            },
            "N10_help": {
                "name": "ë„ì›€ë§ ë° ë¬¸ì„œ",
                "weight": 0.05,
                "items": {
                    "N10.1": "FAQ ì ‘ê·¼ì„±",
                    "N10.2": "ë§¥ë½ ê¸°ë°˜ ë„ì›€ë§",
                    "N10.3": "íŠœí† ë¦¬ì–¼ ì œê³µ"
                }
            }
        }
    
    def map_q_to_nielsen(self, q_scores: Dict[str, float]) -> Dict[str, Dict[str, float]]:
        """
        ê¸°ì¡´ Q1~Q10 ì ìˆ˜ë¥¼ Nielsen 25ê°œ ì„¸ë¶€ í•­ëª©ìœ¼ë¡œ ë§¤í•‘
        
        ë§¤í•‘ ê·œì¹™:
        - Q1 (ëª©ì  ë‹¬ì„±) â†’ N1 (ê°€ì‹œì„±), N6 (ì¸ì‹)
        - Q2 (í¸ë¦¬ì„±) â†’ N3 (ì œì–´), N7 (íš¨ìœ¨ì„±)
        - Q3 (ì´í•´ ê°€ëŠ¥) â†’ N2 (í˜„ì‹¤ ì¼ì¹˜), N10 (ë„ì›€ë§)
        - Q4 (ë©”ë‰´ ì´ë™) â†’ N3 (ì œì–´), N7 (íš¨ìœ¨ì„±)
        - Q5 (ê²½ê³  ë©”ì‹œì§€) â†’ N5 (ì˜ˆë°©), N9 (ë³µêµ¬)
        - Q6 (ì¹œì ˆí•œ ì„¤ëª…) â†’ N6 (ì¸ì‹), N9 (ë³µêµ¬), N10 (ë„ì›€ë§)
        - Q7 (ì‹œê°ì  êµ¬ë¶„) â†’ N1 (ê°€ì‹œì„±), N8 (ë¯¸ë‹ˆë©€)
        - Q8 (ì¼ê´€ì„±) â†’ N4 (ì¼ê´€ì„±)
        - Q9 (ë³´í¸ì  êµ¬ì¡°) â†’ N2 (í˜„ì‹¤ ì¼ì¹˜)
        - Q10 (ìƒ‰ìƒ ì¡°í™”) â†’ N4 (ì¼ê´€ì„±), N8 (ë¯¸ë‹ˆë©€)
        """
        
        nielsen_scores = {}
        
        # N1: ì‹œìŠ¤í…œ ìƒíƒœ ê°€ì‹œì„±
        nielsen_scores["N1_visibility"] = {
            "N1.1": q_scores.get("Q7", 3.5) * 0.9,  # Q7 ê¸°ë°˜, ì•½ê°„ ë³´ìˆ˜ì 
            "N1.2": q_scores.get("Q1", 3.5) * 0.85,  # Q1 ê¸°ë°˜ (ëª©ì  ë‹¬ì„± = ì§„í–‰ ìƒíƒœ íŒŒì•…)
            "N1.3": q_scores.get("Q1", 3.5) * 0.9,
            "overall": (q_scores.get("Q7", 3.5) + q_scores.get("Q1", 3.5)) / 2
        }
        
        # N2: ì‹œìŠ¤í…œê³¼ í˜„ì‹¤ì˜ ì¼ì¹˜
        nielsen_scores["N2_real_world"] = {
            "N2.1": q_scores.get("Q3", 3.5),  # ì´í•´ ê°€ëŠ¥ì„± = ì¹œí™”ì  ìš©ì–´
            "N2.2": q_scores.get("Q9", 3.5),  # ë³´í¸ì  êµ¬ì¡°
            "N2.3": q_scores.get("Q9", 3.5) * 0.95,
            "overall": (q_scores.get("Q3", 3.5) + q_scores.get("Q9", 3.5)) / 2
        }
        
        # N3: ì‚¬ìš©ì ì œì–´ ë° ììœ ë„
        nielsen_scores["N3_control"] = {
            "N3.1": q_scores.get("Q4", 3.5) * 1.05,  # ë©”ë‰´ ì´ë™ = ë’¤ë¡œê°€ê¸°
            "N3.2": q_scores.get("Q2", 3.5) * 0.8,  # í¸ë¦¬ì„± ê¸°ë°˜, ì„ì‹œì €ì¥ì€ ë” ê¹Œë‹¤ë¡œì›€
            "N3.3": q_scores.get("Q2", 3.5) * 0.85,
            "overall": (q_scores.get("Q4", 3.5) + q_scores.get("Q2", 3.5)) / 2
        }
        
        # N4: ì¼ê´€ì„± ë° í‘œì¤€
        nielsen_scores["N4_consistency"] = {
            "N4.1": q_scores.get("Q8", 3.5),  # ì¼ê´€ì„± ì§ì ‘ ì—°ê²°
            "N4.2": q_scores.get("Q10", 3.5),  # ìƒ‰ìƒ ì¡°í™”
            "N4.3": q_scores.get("Q8", 3.5) * 0.95,
            "overall": (q_scores.get("Q8", 3.5) + q_scores.get("Q10", 3.5)) / 2
        }
        
        # N5: ì˜¤ë¥˜ ì˜ˆë°©
        nielsen_scores["N5_prevention"] = {
            "N5.1": q_scores.get("Q5", 3.5) * 0.9,  # ê²½ê³  ë©”ì‹œì§€ ê¸°ë°˜
            "N5.2": q_scores.get("Q5", 3.5) * 0.85,  # ì‹¤ì‹œê°„ ê²€ì‚¬ëŠ” ë” ê¹Œë‹¤ë¡œì›€
            "N5.3": q_scores.get("Q5", 3.5),
            "overall": q_scores.get("Q5", 3.5)
        }
        
        # N6: ê¸°ì–µë³´ë‹¤ ì¸ì‹
        nielsen_scores["N6_recognition"] = {
            "N6.1": q_scores.get("Q6", 3.5) * 0.8,  # ì¹œì ˆí•œ ì„¤ëª… ê¸°ë°˜
            "N6.2": q_scores.get("Q1", 3.5) * 0.85,  # ëª©ì  ë‹¬ì„± = ê²€ìƒ‰ ìš©ì´
            "N6.3": q_scores.get("Q6", 3.5) * 0.95,
            "overall": (q_scores.get("Q6", 3.5) + q_scores.get("Q1", 3.5)) / 2
        }
        
        # N7: ìœ ì—°ì„± ë° íš¨ìœ¨ì„±
        nielsen_scores["N7_flexibility"] = {
            "N7.1": q_scores.get("Q2", 3.5) * 0.7,  # í¸ë¦¬ì„± ê¸°ë°˜, ë‹¨ì¶•í‚¤ëŠ” ì–´ë ¤ì›€
            "N7.2": q_scores.get("Q4", 3.5) * 0.9,  # ë©”ë‰´ ì´ë™ = ì¦ê²¨ì°¾ê¸°
            "N7.3": q_scores.get("Q2", 3.5) * 0.85,
            "overall": (q_scores.get("Q2", 3.5) + q_scores.get("Q4", 3.5)) / 2
        }
        
        # N8: ë¯¸ë‹ˆë©€í•œ ë””ìì¸
        nielsen_scores["N8_minimalist"] = {
            "N8.1": q_scores.get("Q7", 3.5),  # ì‹œê°ì  êµ¬ë¶„
            "N8.2": q_scores.get("Q7", 3.5) * 0.9,
            "N8.3": q_scores.get("Q10", 3.5),  # ìƒ‰ìƒ ì¡°í™” = ê³„ì¸µ êµ¬ì¡°
            "overall": (q_scores.get("Q7", 3.5) + q_scores.get("Q10", 3.5)) / 2
        }
        
        # N9: ì˜¤ë¥˜ ë³µêµ¬ ì§€ì›
        nielsen_scores["N9_error_recovery"] = {
            "N9.1": q_scores.get("Q5", 3.5),  # ê²½ê³  ë©”ì‹œì§€
            "N9.2": q_scores.get("Q6", 3.5) * 0.9,  # ì¹œì ˆí•œ ì„¤ëª… = í•´ê²°ì±…
            "N9.3": q_scores.get("Q5", 3.5) * 0.95,
            "overall": (q_scores.get("Q5", 3.5) + q_scores.get("Q6", 3.5)) / 2
        }
        
        # N10: ë„ì›€ë§ ë° ë¬¸ì„œ
        nielsen_scores["N10_help"] = {
            "N10.1": q_scores.get("Q6", 3.5) * 0.85,  # ì¹œì ˆí•œ ì„¤ëª…
            "N10.2": q_scores.get("Q6", 3.5) * 0.9,
            "N10.3": q_scores.get("Q3", 3.5) * 0.8,  # ì´í•´ ê°€ëŠ¥ = íŠœí† ë¦¬ì–¼
            "overall": (q_scores.get("Q6", 3.5) + q_scores.get("Q3", 3.5)) / 2
        }
        
        return nielsen_scores
    
    def generate_detailed_diagnosis(self, item_code: str, score: float) -> Dict[str, str]:
        """ê° ì„¸ë¶€ í•­ëª©ë³„ êµ¬ì²´ì  ì§„ë‹¨ ë° ê°œì„  ë°©ì•ˆ ìƒì„±"""
        
        # ì§„ë‹¨ í…œí”Œë¦¿ (ì ìˆ˜ êµ¬ê°„ë³„)
        diagnosis_templates = {
            "N1.1": {
                "excellent": (4.5, "âœ… Breadcrumbê°€ ëª¨ë“  í˜ì´ì§€ì— ëª…í™•íˆ í‘œì‹œë˜ë©°, í˜„ì¬ ìœ„ì¹˜ê°€ í•˜ì´ë¼ì´íŠ¸ ì²˜ë¦¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ Breadcrumbê°€ ì¼ë¶€ í˜ì´ì§€ì—ì„œë§Œ ì œê³µë˜ê±°ë‚˜ ì‹œê°ì ìœ¼ë¡œ ëˆˆì— ë„ì§€ ì•ŠìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ Breadcrumbê°€ ì—†ì–´ ì‚¬ìš©ìê°€ í˜„ì¬ ì–´ëŠ í˜ì´ì§€ì— ìˆëŠ”ì§€ íŒŒì•…í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤."),
                "improvement": "ìƒë‹¨ì— 'í™ˆ > ì¹´í…Œê³ ë¦¬ > í˜„ì¬í˜ì´ì§€' í˜•íƒœì˜ Breadcrumbì„ ì¶”ê°€í•˜ê³ , í˜„ì¬ í˜ì´ì§€ëŠ” êµµì€ ê¸€ì”¨ë¡œ ê°•ì¡°í•˜ì„¸ìš”."
            },
            "N1.2": {
                "excellent": (4.5, "âœ… ë¡œë”© ì‹œ ì§„í–‰ë¥  í‘œì‹œ ë˜ëŠ” ìŠ¤í”¼ë„ˆê°€ ëª…í™•íˆ ë‚˜íƒ€ë‚˜ë©°, ì˜ˆìƒ ì†Œìš” ì‹œê°„ì´ í‘œì‹œë©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ë¡œë”© ì¸ë””ì¼€ì´í„°ëŠ” ìˆì§€ë§Œ ì‘ê±°ë‚˜ ëˆˆì— ë„ì§€ ì•ŠìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ ë¡œë”© ìƒíƒœ í‘œì‹œê°€ ì—†ì–´ ì‚¬ìš©ìê°€ ì‹œìŠ¤í…œì´ ì‘ë™ ì¤‘ì¸ì§€ ì•Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),
                "improvement": "ì¤‘ì•™ì— í° ìŠ¤í”¼ë„ˆë¥¼ í‘œì‹œí•˜ê³ , 'ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...' ë©”ì‹œì§€ë¥¼ ì¶”ê°€í•˜ì„¸ìš”. 3ì´ˆ ì´ìƒ ì†Œìš” ì‹œ ì§„í–‰ë¥ (%)ì„ í‘œì‹œí•˜ì„¸ìš”."
            },
            "N1.3": {
                "excellent": (4.5, "âœ… ì‘ì—… ì™„ë£Œ ì‹œ 'ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤' ë“±ì˜ ì„±ê³µ ë©”ì‹œì§€ê°€ ëª…í™•íˆ í‘œì‹œë©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ í”¼ë“œë°±ì´ ì œê³µë˜ì§€ë§Œ ë„ˆë¬´ ë¹ ë¥´ê²Œ ì‚¬ë¼ì§€ê±°ë‚˜ ëˆˆì— ë„ì§€ ì•ŠìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ ì‘ì—… ì™„ë£Œ ì—¬ë¶€ë¥¼ ì•Œ ìˆ˜ ì—†ì–´ ì‚¬ìš©ìê°€ ë¶ˆì•ˆê°ì„ ëŠë‚ë‹ˆë‹¤."),
                "improvement": "í™”ë©´ ìƒë‹¨ì— 3ì´ˆê°„ ë…¹ìƒ‰ ë°°ê²½ì˜ 'âœ“ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤' í† ìŠ¤íŠ¸ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ì„¸ìš”."
            },
            "N2.1": {
                "excellent": (4.5, "âœ… ëª¨ë“  ë©”ë‰´ì™€ ì•ˆë‚´ê°€ ì¼ìƒ ì–¸ì–´ë¡œ ì‘ì„±ë˜ì–´ ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì¼ë¶€ í–‰ì • ìš©ì–´ë‚˜ ì „ë¬¸ ìš©ì–´ê°€ ì‚¬ìš©ë˜ì§€ë§Œ ì„¤ëª…ì´ ì œê³µë©ë‹ˆë‹¤."),
                "poor": (0, "âŒ 'ëŒ€ì¥ì¡°íšŒ', 'í†µí•©ë¯¼ì›' ë“± ì „ë¬¸ ìš©ì–´ê°€ ë‚¨ë°œë˜ì–´ ì¼ë°˜ ì‹œë¯¼ì´ ì´í•´í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤."),
                "improvement": "'ëŒ€ì¥ì¡°íšŒ' â†’ 'ë‚´ ì‹ ì²­ ë‚´ì—­ ë³´ê¸°', 'í†µí•©ë¯¼ì›' â†’ 'ë¬¸ì˜í•˜ê¸°'ë¡œ ë³€ê²½í•˜ê³ , í•„ìš” ì‹œ ë§í’ì„  ì„¤ëª…ì„ ì¶”ê°€í•˜ì„¸ìš”."
            },
            "N2.2": {
                "excellent": (4.5, "âœ… ë©”ë‰´ êµ¬ì¡°ê°€ ì‚¬ìš©ìì˜ ì‹¤ì œ ì—…ë¬´ íë¦„ì„ ë°˜ì˜í•˜ì—¬ ì§ê´€ì ì…ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ë©”ë‰´ êµ¬ì¡°ëŠ” ë…¼ë¦¬ì ì´ì§€ë§Œ ì¼ë¶€ í•­ëª©ì´ ì˜ˆìƒê³¼ ë‹¤ë¥¸ ìœ„ì¹˜ì— ìˆìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ ì¡°ì§ë„ ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ ì°¾ê¸° ì–´ë µìŠµë‹ˆë‹¤."),
                "improvement": "ì¡°ì§ ì¤‘ì‹¬ ë©”ë‰´ë¥¼ ì‚¬ìš©ì ëª©ì  ì¤‘ì‹¬(ì˜ˆ: 'ì‹ ì²­', 'ì¡°íšŒ', 'ìƒë‹´')ìœ¼ë¡œ ì¬êµ¬ì„±í•˜ì„¸ìš”."
            },
            "N2.3": {
                "excellent": (4.5, "âœ… ëª¨ë“  ì•„ì´ì½˜ì´ Material Design ë“± í‘œì¤€ì„ ë”°ë¥´ë©°, ì§ê´€ì ìœ¼ë¡œ ì˜ë¯¸ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ëŒ€ë¶€ë¶„ì˜ ì•„ì´ì½˜ì€ ì´í•´ ê°€ëŠ¥í•˜ì§€ë§Œ ì¼ë¶€ëŠ” ì˜ë¯¸ê°€ ë¶ˆë¶„ëª…í•©ë‹ˆë‹¤."),
                "poor": (0, "âŒ ì¶”ìƒì ì´ê±°ë‚˜ ìƒì†Œí•œ ì•„ì´ì½˜ì´ ì‚¬ìš©ë˜ì–´ ì‚¬ìš©ìê°€ í˜¼ë€ìŠ¤ëŸ¬ì›Œí•©ë‹ˆë‹¤."),
                "improvement": "ğŸ (í™ˆ), ğŸ”(ê²€ìƒ‰), ğŸ“„(ë¬¸ì„œ) ë“± ë³´í¸ì  ì•„ì´ì½˜ì„ ì‚¬ìš©í•˜ê³ , ëª¨ë“  ì•„ì´ì½˜ì— í…ìŠ¤íŠ¸ ë ˆì´ë¸”ì„ ë³‘ê¸°í•˜ì„¸ìš”."
            },
            "N3.1": {
                "excellent": (4.5, "âœ… ëª¨ë“  í˜ì´ì§€ì— 'ì´ì „' ë²„íŠ¼ì´ ëª…í™•íˆ í‘œì‹œë˜ë©°, ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸°ë„ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ë’¤ë¡œê°€ê¸° ë²„íŠ¼ì€ ìˆì§€ë§Œ ì¼ë¶€ í˜ì´ì§€ì—ì„œ ëˆ„ë½ë˜ê±°ë‚˜ ëˆˆì— ë„ì§€ ì•ŠìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ ë’¤ë¡œê°€ê¸° ì‹œ ì…ë ¥í•œ ë°ì´í„°ê°€ ì†ì‹¤ë˜ê±°ë‚˜, ë’¤ë¡œê°€ê¸° ë²„íŠ¼ì´ ì—†ì–´ ë‹µë‹µí•¨ì„ ëŠë‚ë‹ˆë‹¤."),
                "improvement": "ìƒë‹¨ ì¢Œì¸¡ì— 'â† ì´ì „' ë²„íŠ¼ì„ ë°°ì¹˜í•˜ê³ , ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸°ì™€ ì—°ë™í•˜ì—¬ ë°ì´í„°ë¥¼ ë³´ì¡´í•˜ì„¸ìš”."
            },
            "N3.2": {
                "excellent": (4.5, "âœ… ê¸´ ì‹ ì²­ì„œì—ì„œ 5ë¶„ë§ˆë‹¤ ìë™ ì €ì¥ë˜ë©°, 'ì„ì‹œ ì €ì¥' ë²„íŠ¼ë„ ì œê³µë©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì„ì‹œ ì €ì¥ ê¸°ëŠ¥ì€ ìˆì§€ë§Œ ìë™ ì €ì¥ì´ ì—†ê±°ë‚˜ ì €ì¥ ì‹œì ì„ ì•Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ ì„ì‹œ ì €ì¥ ê¸°ëŠ¥ì´ ì—†ì–´ ì‚¬ìš©ìê°€ ì‹¤ìˆ˜ë¡œ í˜ì´ì§€ë¥¼ ë‹«ìœ¼ë©´ ëª¨ë“  ì…ë ¥ì´ ë‚ ì•„ê°‘ë‹ˆë‹¤."),
                "improvement": "5ë¶„ë§ˆë‹¤ ìë™ ì €ì¥í•˜ê³ , 'ë§ˆì§€ë§‰ ì €ì¥: 2ë¶„ ì „' ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ì„¸ìš”. 'ì„ì‹œ ì €ì¥' ë²„íŠ¼ì„ ìš°ì¸¡ í•˜ë‹¨ì— ë°°ì¹˜í•˜ì„¸ìš”."
            },
            "N3.3": {
                "excellent": (4.5, "âœ… ì‚¬ìš©ìê°€ ê²€ìƒ‰ ê¸°ë¡, ì¦ê²¨ì°¾ê¸° ë“±ì„ ììœ ë¡­ê²Œ ì‚­ì œí•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì¼ë¶€ ë°ì´í„°ëŠ” ê´€ë¦¬ ê°€ëŠ¥í•˜ì§€ë§Œ ê²€ìƒ‰ ê¸°ë¡ ì‚­ì œ ë“± ì¼ë¶€ ê¸°ëŠ¥ì´ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ ì‚¬ìš©ìê°€ ìì‹ ì˜ ë°ì´í„°ë¥¼ ì œì–´í•  ìˆ˜ ì—†ì–´ í”„ë¼ì´ë²„ì‹œ ìš°ë ¤ê°€ ìˆìŠµë‹ˆë‹¤."),
                "improvement": "ê²€ìƒ‰ì°½ ìš°ì¸¡ì— 'ê¸°ë¡ ì§€ìš°ê¸°' ë²„íŠ¼ì„ ì¶”ê°€í•˜ê³ , ì„¤ì • í˜ì´ì§€ì—ì„œ ëª¨ë“  í™œë™ ë°ì´í„°ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í•˜ì„¸ìš”."
            },
            "N4.1": {
                "excellent": (4.5, "âœ… ëª¨ë“  ì£¼ìš” ë²„íŠ¼ì´ ë™ì¼í•œ ìƒ‰ìƒê³¼ í¬ê¸°ë¥¼ ìœ ì§€í•˜ë©°, ìœ„ì¹˜ë„ ì¼ê´€ì ì…ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ëŒ€ë¶€ë¶„ì˜ ë²„íŠ¼ì€ ì¼ê´€ì ì´ì§€ë§Œ ì¼ë¶€ í˜ì´ì§€ì—ì„œ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ì´ ì‚¬ìš©ë©ë‹ˆë‹¤."),
                "poor": (0, "âŒ í˜ì´ì§€ë§ˆë‹¤ ë²„íŠ¼ ìƒ‰ìƒê³¼ ìœ„ì¹˜ê°€ ë‹¬ë¼ ì‚¬ìš©ìê°€ í˜¼ë€ìŠ¤ëŸ¬ì›Œí•©ë‹ˆë‹¤."),
                "improvement": "ë””ìì¸ ì‹œìŠ¤í…œì„ ì •ì˜í•˜ì„¸ìš”. ì˜ˆ: Primary ë²„íŠ¼(íŒŒë€ìƒ‰, ìš°ì¸¡), Secondary ë²„íŠ¼(íšŒìƒ‰, ì¢Œì¸¡), Danger ë²„íŠ¼(ë¹¨ê°„ìƒ‰)."
            },
            "N4.2": {
                "excellent": (4.5, "âœ… ë¸Œëœë“œ ì»¬ëŸ¬ê°€ ëª¨ë“  í˜ì´ì§€ì— ì¼ê´€ë˜ê²Œ ì ìš©ë˜ë©°, Primary/Secondary ìƒ‰ìƒì´ ëª…í™•í•©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ìƒ‰ìƒ ì²´ê³„ëŠ” ìˆì§€ë§Œ ì¼ë¶€ í˜ì´ì§€ì—ì„œ ë‹¤ë¥¸ ìƒ‰ìƒì´ í˜¼ì¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ í˜ì´ì§€ë§ˆë‹¤ ìƒ‰ìƒì´ ë‹¤ë¥´ê³ , ë¸Œëœë“œ ì •ì²´ì„±ì„ ëŠë‚„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),
                "improvement": "Primary: #0066CC, Secondary: #6C757D, Success: #28A745, Danger: #DC3545, Warning: #FFC107ë¡œ í†µì¼í•˜ì„¸ìš”."
            },
            "N4.3": {
                "excellent": (4.5, "âœ… ì œëª©(24px êµµê²Œ), ë³¸ë¬¸(16px ë³´í†µ), ìº¡ì…˜(14px ì–‡ê²Œ) ë“± íƒ€ì´í¬ê·¸ë˜í”¼ ê³„ì¸µì´ ëª…í™•í•©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ê¸€ê¼´ í¬ê¸°ëŠ” êµ¬ë¶„ë˜ì§€ë§Œ ì¼ë¶€ í˜ì´ì§€ì—ì„œ ë‹¤ë¥¸ êµµê¸°ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤."),
                "poor": (0, "âŒ ê¸€ê¼´ í¬ê¸°ì™€ êµµê¸°ê°€ ì¼ê´€ì„± ì—†ì´ ì‚¬ìš©ë˜ì–´ ì‹œê°ì  ê³„ì¸µì´ ë¶ˆë¶„ëª…í•©ë‹ˆë‹¤."),
                "improvement": "H1: 32px Bold, H2: 24px Semi-bold, ë³¸ë¬¸: 16px Regular, ìº¡ì…˜: 14px Lightë¡œ í†µì¼í•˜ì„¸ìš”."
            },
            "N5.1": {
                "excellent": (4.5, "âœ… ëª¨ë“  ì…ë ¥ í•„ë“œì— 'ì˜ˆ: 010-1234-5678' í˜•íƒœì˜ ëª…í™•í•œ ê°€ì´ë“œê°€ ì œê³µë©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì¼ë¶€ í•„ë“œì—ë§Œ ê°€ì´ë“œê°€ ìˆê±°ë‚˜, ê°€ì´ë“œê°€ ë¶ˆëª…í™•í•©ë‹ˆë‹¤."),
                "poor": (0, "âŒ ì…ë ¥ í˜•ì‹ ì•ˆë‚´ê°€ ì—†ì–´ ì‚¬ìš©ìê°€ ì‹œí–‰ì°©ì˜¤ë¥¼ ê²ªìŠµë‹ˆë‹¤."),
                "improvement": "ì…ë ¥ í•„ë“œ ì•„ë˜ì— íšŒìƒ‰ ì‘ì€ ê¸€ì”¨ë¡œ 'ì˜ˆ: 010-1234-5678' ë˜ëŠ” placeholderë¡œ í‘œì‹œí•˜ì„¸ìš”."
            },
            "N5.2": {
                "excellent": (4.5, "âœ… ì…ë ¥ ì¤‘ ë˜ëŠ” í¬ì»¤ìŠ¤ ì•„ì›ƒ ì‹œ ì¦‰ì‹œ ìœ íš¨ì„± ê²€ì‚¬ê°€ ìˆ˜í–‰ë˜ê³  ì˜¤ë¥˜ê°€ í‘œì‹œë©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ìœ íš¨ì„± ê²€ì‚¬ëŠ” ìˆì§€ë§Œ ì œì¶œ ë²„íŠ¼ì„ ëˆŒëŸ¬ì•¼ë§Œ í™•ì¸ë©ë‹ˆë‹¤."),
                "poor": (0, "âŒ ì œì¶œ í›„ì—ì•¼ ì˜¤ë¥˜ë¥¼ ì•Œ ìˆ˜ ìˆì–´ ì‚¬ìš©ìê°€ ë¶ˆí¸ì„ ëŠë‚ë‹ˆë‹¤."),
                "improvement": "ì…ë ¥ í•„ë“œì—ì„œ í¬ì»¤ìŠ¤ê°€ ë²—ì–´ë‚  ë•Œ ì¦‰ì‹œ ê²€ì‚¬í•˜ê³ , ì˜¤ë¥˜ ì‹œ ë¹¨ê°„ìƒ‰ í…Œë‘ë¦¬ + ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ì„¸ìš”."
            },
            "N5.3": {
                "excellent": (4.5, "âœ… ì‚­ì œ, ì œì¶œ ë“± ì¤‘ìš”í•œ ì‘ì—… ì „ 'ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?' í™•ì¸ ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì¼ë¶€ ì¤‘ìš” ì‘ì—…ì—ë§Œ í™•ì¸ ë©”ì‹œì§€ê°€ ì œê³µë©ë‹ˆë‹¤."),
                "poor": (0, "âŒ ì‚­ì œ ë²„íŠ¼ í´ë¦­ ì¦‰ì‹œ ì‚­ì œë˜ì–´ ì‚¬ìš©ìê°€ ì‹¤ìˆ˜ë¡œ ë°ì´í„°ë¥¼ ìƒì„ ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤."),
                "improvement": "ì‚­ì œ/ì œì¶œ ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ ì°½ì„ ë„ìš°ê³ , 'ì·¨ì†Œ' / 'í™•ì¸' ë²„íŠ¼ì„ ì œê³µí•˜ì„¸ìš”."
            },
            "N6.1": {
                "excellent": (4.5, "âœ… ê²€ìƒ‰ì°½ í´ë¦­ ì‹œ ìµœê·¼ 5ê°œ ê²€ìƒ‰ì–´ê°€ ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ í‘œì‹œë˜ë©°, í´ë¦­ í•œ ë²ˆìœ¼ë¡œ ì¬ê²€ìƒ‰ ê°€ëŠ¥í•©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ìµœê·¼ ê²€ìƒ‰ì–´ëŠ” í‘œì‹œë˜ì§€ë§Œ ìˆ˜ëŸ‰ì´ ì ê±°ë‚˜ ì‚­ì œ ê¸°ëŠ¥ì´ ì—†ìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ ê²€ìƒ‰ì–´ë¥¼ ë§¤ë²ˆ ìƒˆë¡œ ì…ë ¥í•´ì•¼ í•˜ì—¬ ë°˜ë³µ ì‘ì—… ì‹œ ë¶ˆí¸í•©ë‹ˆë‹¤."),
                "improvement": "ê²€ìƒ‰ì°½ í¬ì»¤ìŠ¤ ì‹œ ìµœê·¼ 5ê°œ ê²€ìƒ‰ì–´ë¥¼ ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ í‘œì‹œí•˜ê³ , ê° í•­ëª©ì— 'X' ì‚­ì œ ë²„íŠ¼ì„ ì¶”ê°€í•˜ì„¸ìš”."
            },
            "N6.2": {
                "excellent": (4.5, "âœ… ì…ë ¥ ì¤‘ ì‹¤ì‹œê°„ìœ¼ë¡œ ì—°ê´€ ê²€ìƒ‰ì–´ê°€ ì œì•ˆë˜ë©°, í™”ì‚´í‘œ í‚¤ë¡œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ìë™ì™„ì„±ì€ ìˆì§€ë§Œ ì •í™•ë„ê°€ ë‚®ê±°ë‚˜ ë°˜ì‘ì´ ëŠë¦½ë‹ˆë‹¤."),
                "poor": (0, "âŒ ìë™ì™„ì„± ê¸°ëŠ¥ì´ ì—†ì–´ ê¸´ ê²€ìƒ‰ì–´ë¥¼ ëê¹Œì§€ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤."),
                "improvement": "Google ìŠ¤íƒ€ì¼ ìë™ì™„ì„±ì„ êµ¬í˜„í•˜ì„¸ìš”. 2ê¸€ì ì´ìƒ ì…ë ¥ ì‹œ ìƒìœ„ 5ê°œ ì œì•ˆì„ ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ í‘œì‹œí•˜ì„¸ìš”."
            },
            "N6.3": {
                "excellent": (4.5, "âœ… ëª¨ë“  ì•„ì´ì½˜ê³¼ ë²„íŠ¼ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ íˆ´íŒì´ ë‚˜íƒ€ë‚˜ ê¸°ëŠ¥ì„ ì„¤ëª…í•©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì¼ë¶€ ì•„ì´ì½˜ì—ë§Œ íˆ´íŒì´ ì œê³µë˜ê±°ë‚˜, ì„¤ëª…ì´ ë¶ˆëª…í™•í•©ë‹ˆë‹¤."),
                "poor": (0, "âŒ ì•„ì´ì½˜ë§Œ ìˆê³  ì„¤ëª…ì´ ì—†ì–´ ì‚¬ìš©ìê°€ ê¸°ëŠ¥ì„ ì¶”ì¸¡í•´ì•¼ í•©ë‹ˆë‹¤."),
                "improvement": "ëª¨ë“  ì•„ì´ì½˜ì— title ì†ì„±ì„ ì¶”ê°€í•˜ê³ , hover ì‹œ 0.5ì´ˆ í›„ íˆ´íŒì„ í‘œì‹œí•˜ì„¸ìš”. ì˜ˆ: 'ì¶œë ¥', 'ë‹¤ìš´ë¡œë“œ', 'ê³µìœ '."
            },
            "N7.1": {
                "excellent": (4.5, "âœ… Ctrl+S(ì €ì¥), Enter(ê²€ìƒ‰), Tab(í•„ë“œ ì´ë™) ë“± ì£¼ìš” ë‹¨ì¶•í‚¤ê°€ ì§€ì›ë˜ë©° ì•ˆë‚´ê°€ ì œê³µë©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì¼ë¶€ ë‹¨ì¶•í‚¤ëŠ” ì‘ë™í•˜ì§€ë§Œ ì•ˆë‚´ê°€ ì—†ì–´ ì‚¬ìš©ìê°€ ì•Œê¸° ì–´ë µìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ í‚¤ë³´ë“œë§Œìœ¼ë¡œëŠ” ì‘ì—…ì´ ë¶ˆê°€ëŠ¥í•˜ë©°, ë§ˆìš°ìŠ¤ì— ì˜ì¡´í•´ì•¼ í•©ë‹ˆë‹¤."),
                "improvement": "ì£¼ìš” ë²„íŠ¼ì— 'Ctrl+Së¡œ ì €ì¥' íŒíŠ¸ë¥¼ í‘œì‹œí•˜ê³ , ë„ì›€ë§ì— ë‹¨ì¶•í‚¤ ëª©ë¡ì„ ì œê³µí•˜ì„¸ìš”."
            },
            "N7.2": {
                "excellent": (4.5, "âœ… ìƒë‹¨ì— 'ìì£¼ ì°¾ëŠ” ë©”ë‰´'ê°€ ìˆìœ¼ë©°, ì‚¬ìš©ìê°€ ë“œë˜ê·¸ë¡œ ìˆœì„œë¥¼ ë³€ê²½í•˜ê³  ì¶”ê°€/ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥ì€ ìˆì§€ë§Œ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì´ ì œí•œì ì…ë‹ˆë‹¤."),
                "poor": (0, "âŒ ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥ì´ ì—†ì–´ ìì£¼ ì“°ëŠ” ë©”ë‰´ë¥¼ ë§¤ë²ˆ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤."),
                "improvement": "ê° ë©”ë‰´ ì˜†ì— 'â˜… ì¦ê²¨ì°¾ê¸° ì¶”ê°€' ë²„íŠ¼ì„ ë°°ì¹˜í•˜ê³ , ìƒë‹¨ì— ì¦ê²¨ì°¾ê¸° ë°”ë¥¼ ê³ ì •í•˜ì„¸ìš”."
            },
            "N7.3": {
                "excellent": (4.5, "âœ… ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë‚ ì§œ, ì¹´í…Œê³ ë¦¬, ì§€ì—­ ë“± ë‹¤ì–‘í•œ í•„í„°ë¡œ ì •ë ¬í•˜ê³  ì¢í ìˆ˜ ìˆìŠµë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ê¸°ë³¸ í•„í„°(ë‚ ì§œ)ëŠ” ìˆì§€ë§Œ ê³ ê¸‰ ì˜µì…˜ì´ ë¶€ì¡±í•©ë‹ˆë‹¤."),
                "poor": (0, "âŒ ê²€ìƒ‰ ì‹œ í•„í„°ê°€ ì—†ì–´ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì°¾ê¸° ì–´ë µìŠµë‹ˆë‹¤."),
                "improvement": "ì¢Œì¸¡ ì‚¬ì´ë“œë°”ì— 'í•„í„°: ë‚ ì§œ, ì¹´í…Œê³ ë¦¬, ì§€ì—­' ì²´í¬ë°•ìŠ¤ë¥¼ ì¶”ê°€í•˜ê³ , 'ì •ë ¬: ìµœì‹ ìˆœ/ì¸ê¸°ìˆœ'ì„ ì œê³µí•˜ì„¸ìš”."
            },
            "N8.1": {
                "excellent": (4.5, "âœ… í•œ í™”ë©´ì— í•µì‹¬ ì •ë³´ë§Œ í‘œì‹œë˜ë©°, ì¶”ê°€ ì •ë³´ëŠ” 'ë”ë³´ê¸°'ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì •ë³´ëŸ‰ì€ ì ì ˆí•˜ì§€ë§Œ ì¼ë¶€ í˜ì´ì§€ì—ì„œ ê³¼ë„í•œ í…ìŠ¤íŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤."),
                "poor": (0, "âŒ í•œ í™”ë©´ì— ë„ˆë¬´ ë§ì€ ì •ë³´ê°€ ë¹½ë¹½í•˜ê²Œ í‘œì‹œë˜ì–´ ì••ë„ê°ì„ ëŠë‚ë‹ˆë‹¤."),
                "improvement": "ì •ë³´ë¥¼ íƒ­ì´ë‚˜ ì•„ì½”ë””ì–¸ìœ¼ë¡œ ìˆ¨ê¸°ê³ , ì²« í™”ë©´ì—ëŠ” ì£¼ìš” CTAì™€ 3~5ê°œ í•µì‹¬ ë©”ë‰´ë§Œ í‘œì‹œí•˜ì„¸ìš”."
            },
            "N8.2": {
                "excellent": (4.5, "âœ… ìš”ì†Œ ê°„ ì—¬ë°±ì´ ì¶©ë¶„í•˜ê³ (20px ì´ìƒ), ê·¸ë¦¬ë“œ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ì—¬ ì •ëˆëœ ëŠë‚Œì„ ì¤ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì—¬ë°±ì€ ìˆì§€ë§Œ ì¼ë¶€ ì˜ì—­ì´ ë‹µë‹µí•˜ê±°ë‚˜ ë¶ˆê·œì¹™í•©ë‹ˆë‹¤."),
                "poor": (0, "âŒ ì—¬ë°± ì—†ì´ ìš”ì†Œë“¤ì´ ë¶™ì–´ ìˆì–´ ë‹µë‹µí•˜ê³  ê°€ë…ì„±ì´ ë–¨ì–´ì§‘ë‹ˆë‹¤."),
                "improvement": "ìš”ì†Œ ê°„ ìµœì†Œ 20px ì—¬ë°±ì„ í™•ë³´í•˜ê³ , 12-column ê·¸ë¦¬ë“œ ì‹œìŠ¤í…œì„ ì ìš©í•˜ì„¸ìš”."
            },
            "N8.3": {
                "excellent": (4.5, "âœ… ì œëª©ì´ ê°€ì¥ í¬ê³  êµµìœ¼ë©°, ì¤‘ìš”ë„ì— ë”°ë¼ í¬ê¸°ì™€ ìƒ‰ìƒì´ ì°¨ë“± ì ìš©ë˜ì–´ ì‹œì„  íë¦„ì´ ëª…í™•í•©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì œëª©ê³¼ ë³¸ë¬¸ì€ êµ¬ë¶„ë˜ì§€ë§Œ ì¤‘ìš”ë„ í‘œì‹œê°€ ë¶ˆëª…í™•í•©ë‹ˆë‹¤."),
                "poor": (0, "âŒ ëª¨ë“  í…ìŠ¤íŠ¸ê°€ ë¹„ìŠ·í•œ í¬ê¸°ì™€ ìƒ‰ìƒìœ¼ë¡œ ë˜ì–´ ìˆì–´ ì–´ë””ë¥¼ ë¨¼ì € ë´ì•¼ í• ì§€ ëª¨ë¦…ë‹ˆë‹¤."),
                "improvement": "ì œëª©(32px, ê²€ì€ìƒ‰), ë¶€ì œëª©(24px, ì§„íšŒìƒ‰), ë³¸ë¬¸(16px, íšŒìƒ‰)ìœ¼ë¡œ ê³„ì¸µì„ ëª…í™•íˆ í•˜ê³ , ì£¼ìš” CTAëŠ” í° ë²„íŠ¼ìœ¼ë¡œ ê°•ì¡°í•˜ì„¸ìš”."
            },
            "N9.1": {
                "excellent": (4.5, "âœ… ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ 'ì´ë©”ì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ì˜ˆ: user@example.com' ì²˜ëŸ¼ êµ¬ì²´ì ì…ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì˜¤ë¥˜ ë©”ì‹œì§€ëŠ” ì œê³µë˜ì§€ë§Œ 'ì˜ëª»ëœ ì…ë ¥' ë“± ì¶”ìƒì ì…ë‹ˆë‹¤."),
                "poor": (0, "âŒ 'Error 500: Internal Server Error' ë“± ê¸°ìˆ  ìš©ì–´ë¡œë§Œ í‘œì‹œë˜ì–´ ì‚¬ìš©ìê°€ ì´í•´í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),
                "improvement": "ê¸°ìˆ  ìš©ì–´ ëŒ€ì‹  'ì¼ì‹œì  ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.' í˜•íƒœë¡œ ë³€ê²½í•˜ì„¸ìš”."
            },
            "N9.2": {
                "excellent": (4.5, "âœ… ì˜¤ë¥˜ ë©”ì‹œì§€ì— '@ ê¸°í˜¸ë¥¼ í¬í•¨í•´ì£¼ì„¸ìš”' ë“± êµ¬ì²´ì ì¸ í•´ê²° ë°©ë²•ì´ ì œì‹œë©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ í•´ê²°ì±…ì´ ì œê³µë˜ì§€ë§Œ ë¶ˆëª…í™•í•˜ê±°ë‚˜ ë§í¬ë§Œ ì œê³µë©ë‹ˆë‹¤."),
                "poor": (0, "âŒ ë¬¸ì œë§Œ ì•Œë ¤ì£¼ê³  í•´ê²° ë°©ë²•ì€ ì œê³µí•˜ì§€ ì•Šì•„ ì‚¬ìš©ìê°€ ë‹µë‹µí•¨ì„ ëŠë‚ë‹ˆë‹¤."),
                "improvement": "ì˜¤ë¥˜ ë©”ì‹œì§€ ì•„ë˜ì— 'í•´ê²° ë°©ë²•: ì „í™”ë²ˆí˜¸ëŠ” 010-1234-5678 í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”' ì•ˆë‚´ë¥¼ ì¶”ê°€í•˜ì„¸ìš”."
            },
            "N9.3": {
                "excellent": (4.5, "âœ… ì˜¤ë¥˜ê°€ ë°œìƒí•œ ì…ë ¥ í•„ë“œê°€ ë¹¨ê°„ìƒ‰ í…Œë‘ë¦¬ë¡œ ê°•ì¡°ë˜ë©°, ìë™ìœ¼ë¡œ ìŠ¤í¬ë¡¤ë©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì˜¤ë¥˜ í•„ë“œëŠ” ê°•ì¡°ë˜ì§€ë§Œ ìŠ¤í¬ë¡¤ë˜ì§€ ì•Šì•„ ì°¾ê¸° ì–´ë µìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ ì˜¤ë¥˜ ìœ„ì¹˜ë¥¼ ì•Œ ìˆ˜ ì—†ì–´ ì‚¬ìš©ìê°€ ì „ì²´ í¼ì„ ë‹¤ì‹œ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤."),
                "improvement": "ì˜¤ë¥˜ í•„ë“œì— ë¹¨ê°„ìƒ‰ í…Œë‘ë¦¬ë¥¼ ì ìš©í•˜ê³ , scrollIntoView()ë¡œ ìë™ ìŠ¤í¬ë¡¤í•˜ì„¸ìš”."
            },
            "N10.1": {
                "excellent": (4.5, "âœ… í—¤ë”ì— 'ë„ì›€ë§' ë©”ë‰´ê°€ ìˆìœ¼ë©°, FAQ í˜ì´ì§€ì— ê²€ìƒ‰ ê¸°ëŠ¥ì´ ì œê³µë©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ FAQëŠ” ìˆì§€ë§Œ ì ‘ê·¼ì´ ì–´ë µê±°ë‚˜ ê²€ìƒ‰ ê¸°ëŠ¥ì´ ì—†ìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ ë„ì›€ë§ì´ í‘¸í„° ê¹Šìˆ™ì´ ìˆ¨ê²¨ì ¸ ìˆê±°ë‚˜ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."),
                "improvement": "ìƒë‹¨ í—¤ë” ìš°ì¸¡ì— 'â“ ë„ì›€ë§' ë²„íŠ¼ì„ ê³ ì •í•˜ê³ , FAQ í˜ì´ì§€ì— í‚¤ì›Œë“œ ê²€ìƒ‰ì°½ì„ ì¶”ê°€í•˜ì„¸ìš”."
            },
            "N10.2": {
                "excellent": (4.5, "âœ… ê° í˜ì´ì§€/ì„¹ì…˜ì— 'ì´ í˜ì´ì§€ì— ëŒ€í•œ ë„ì›€ë§' ë§í¬ê°€ ìˆìœ¼ë©°, í´ë¦­ ì‹œ ê´€ë ¨ ì„¤ëª…ì´ íŒì—…ìœ¼ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ ì¼ë¶€ í˜ì´ì§€ì—ë§Œ ë„ì›€ë§ì´ ì œê³µë˜ê±°ë‚˜ ì¼ë°˜ì ì¸ ì•ˆë‚´ë§Œ ìˆìŠµë‹ˆë‹¤."),
                "poor": (0, "âŒ í˜ì´ì§€ë³„ ë„ì›€ë§ì´ ì—†ì–´ ì‚¬ìš©ìê°€ ì „ì²´ ë§¤ë‰´ì–¼ì„ ë’¤ì ¸ì•¼ í•©ë‹ˆë‹¤."),
                "improvement": "ê° ì„¹ì…˜ ì œëª© ì˜†ì— '?' ì•„ì´ì½˜ì„ ë°°ì¹˜í•˜ê³ , í´ë¦­ ì‹œ í•´ë‹¹ ê¸°ëŠ¥ ì„¤ëª… íŒì—…ì„ í‘œì‹œí•˜ì„¸ìš”."
            },
            "N10.3": {
                "excellent": (4.5, "âœ… ì²« ë°©ë¬¸ ì‹œ ì¸í„°ë™í‹°ë¸Œ ê°€ì´ë“œ íˆ¬ì–´ê°€ ì œê³µë˜ë©°, 'íŠœí† ë¦¬ì–¼ ê±´ë„ˆë›°ê¸°' ì˜µì…˜ë„ ìˆìŠµë‹ˆë‹¤."),
                "good": (3.5, "âš ï¸ íŠœí† ë¦¬ì–¼ì€ ìˆì§€ë§Œ ì •ì  ë¬¸ì„œ í˜•íƒœë¡œë§Œ ì œê³µë©ë‹ˆë‹¤."),
                "poor": (0, "âŒ íŠœí† ë¦¬ì–¼ì´ ì—†ì–´ ì‹ ê·œ ì‚¬ìš©ìê°€ ì‚¬ìš©ë²•ì„ ìŠ¤ìŠ¤ë¡œ íŒŒì•…í•´ì•¼ í•©ë‹ˆë‹¤."),
                "improvement": "ì²« ë¡œê·¸ì¸ ì‹œ 'í™˜ì˜í•©ë‹ˆë‹¤! 3ë¶„ ê°€ì´ë“œë¥¼ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?' ëª¨ë‹¬ì„ í‘œì‹œí•˜ê³ , ì£¼ìš” ê¸°ëŠ¥ì„ í•˜ì´ë¼ì´íŠ¸í•˜ë©° ì„¤ëª…í•˜ì„¸ìš”."
            }
        }
        
        template = diagnosis_templates.get(item_code, {})
        
        if score >= template.get("excellent", (4.5, ""))[0]:
            diagnosis = template.get("excellent", (0, "í‰ê°€ ì¤‘"))[1]
            level = "excellent"
        elif score >= template.get("good", (3.5, ""))[0]:
            diagnosis = template.get("good", (0, "í‰ê°€ ì¤‘"))[1]
            level = "good"
        else:
            diagnosis = template.get("poor", (0, "í‰ê°€ ì¤‘"))[1]
            level = "poor"
        
        improvement = template.get("improvement", "ì¶”ê°€ ë¶„ì„ í•„ìš”")
        
        return {
            "score": round(score, 2),
            "level": level,
            "diagnosis": diagnosis,
            "improvement": improvement
        }
    
    def analyze_site(self, site_name: str, q_scores: Dict[str, float]) -> Dict:
        """íŠ¹ì • ì‚¬ì´íŠ¸ì˜ Nielsen ê¸°ë°˜ ìƒì„¸ ë¶„ì„ ìˆ˜í–‰"""
        
        # Q1~Q10 â†’ Nielsen 25ê°œ í•­ëª© ë§¤í•‘
        nielsen_scores = self.map_q_to_nielsen(q_scores)
        
        # ê° í•­ëª©ë³„ ìƒì„¸ ì§„ë‹¨ ìƒì„±
        detailed_report = {}
        
        for principle_code, principle_info in self.nielsen_criteria.items():
            principle_name = principle_info["name"]
            items = principle_info["items"]
            
            detailed_report[principle_code] = {
                "name": principle_name,
                "weight": principle_info["weight"],
                "overall_score": round(nielsen_scores[principle_code]["overall"], 2),
                "items": {}
            }
            
            for item_code, item_name in items.items():
                item_score = nielsen_scores[principle_code][item_code]
                diagnosis = self.generate_detailed_diagnosis(item_code, item_score)
                
                detailed_report[principle_code]["items"][item_code] = {
                    "name": item_name,
                    "score": diagnosis["score"],
                    "level": diagnosis["level"],
                    "diagnosis": diagnosis["diagnosis"],
                    "improvement": diagnosis["improvement"]
                }
        
        # ì¢…í•© ì ìˆ˜ ê³„ì‚° (ê°€ì¤‘ í‰ê· )
        overall_score = sum(
            detailed_report[code]["overall_score"] * self.nielsen_criteria[code]["weight"]
            for code in self.nielsen_criteria.keys()
        )
        
        return {
            "site_name": site_name,
            "overall_score": round(overall_score, 2),
            "principles": detailed_report,
            "original_scores": q_scores
        }
    
    def analyze_all_sites(self):
        """49ê°œ ê¸°ê´€ ì „ì²´ Nielsen ìƒì„¸ ë¶„ì„"""
        
        print("ğŸ“Š Nielsen 10ì›ì¹™ ê¸°ë°˜ ìƒì„¸ ë¶„ì„ ì‹œì‘...")
        
        # ì—°ë ¹ëŒ€ íŒŒì¼ ë¡œë“œ
        age_groups = ["20ëŒ€", "30ëŒ€", "40ëŒ€", "50ëŒ€", "60ëŒ€ì´ìƒ", "ë””ì§€í„¸ì·¨ì•½ê³„ì¸µ"]
        all_sites = []
        
        for age_group in age_groups:
            file_path = self.data_dir / f"UI_UX í‰ê°€ì‹œìŠ¤í…œ_{age_group}.xlsx"
            if not file_path.exists():
                print(f"âš ï¸ íŒŒì¼ ì—†ìŒ: {file_path}")
                continue
            
            df = pd.read_excel(file_path)
            
            for _, row in df.iterrows():
                site_name = row["ê¸°ê´€ëª…"]
                
                # Q1~Q10 ì ìˆ˜ ì¶”ì¶œ
                q_scores = {
                    "Q1": row.get("1.ì›í•˜ëŠ” ëª©ì ì„ ë‹¬ì„±í•  ìˆ˜ ìˆì—ˆë‚˜ìš”?", 3.5),
                    "Q2": row.get("2.ì„œë¹„ìŠ¤ ì´ìš©ì´ í¸ë¦¬ í–ˆë‚˜ìš”?", 3.5),
                    "Q3": row.get("3. ì „ë¬¸ì„± ì—†ì´ë„ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆì—ˆë‚˜ìš”?", 3.5),
                    "Q4": row.get("4. ì–´ë–¤ í˜ì´ì§€ì—ì„œ ë“  ë©”ë‰´ ì´ë™ì´ ì‰¬ì› ë‚˜ìš”?", 3.5),
                    "Q5": row.get("5. ì˜ëª» ì…ë ¥í–ˆì„ ê²½ìš° ê²½ê³  ë©”ì‹œì§€ê°€ í‘œì‹œë˜ë‚˜ìš”?", 3.5),
                    "Q6": row.get("6. ë‹¹ì‹ ì´ ì›í•˜ëŠ” ì„œë¹„ìŠ¤(ì‹ ì²­, ì¡°íšŒ ì½˜í…ì¸  ìƒì„¸ ë“±) ì´ìš©ì— ëŒ€í•´ ì¹œì ˆí•˜ê²Œ ì„¤ëª…í•´ ì£¼ì—ˆë‚˜ìš”?", 3.5),
                    "Q7": row.get("7. ì‹œê°ì ìœ¼ë¡œ ì„œë¹„ìŠ¤ì˜ ë‚´ìš©ì´ ì˜ êµ¬ë¶„ë˜ì–´ ìˆë‚˜ìš”?", 3.5),
                    "Q8": row.get("8. ì œëª©, ê¸€ë¨¸ë¦¬í‘œ, ì•„ì´ì½˜, ì´ë¯¸ì§€ ë“±ì´ ì¼ê´€ì„± ìˆê²Œ ë°°ì¹˜ë˜ì–´ í†µì¼ê° ìˆê²Œ ëŠë¼ì…¨ë‚˜ìš”?", 3.5),
                    "Q9": row.get("9. ë³´í¸ì ì´ê³  ìµìˆ™í•œ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‚˜ìš”?", 3.5),
                    "Q10": row.get("10. ìƒ‰ìƒê°„ì˜ ì¡°í™”ê°€ ì˜ ì´ë£¨ì–´ì§€ê³  ìˆë‚˜ìš”?", 3.5)
                }
                
                all_sites.append({
                    "site_name": site_name,
                    "age_group": age_group,
                    "q_scores": q_scores
                })
        
        # ê¸°ê´€ë³„ í‰ê·  ì ìˆ˜ ê³„ì‚°
        site_avg = {}
        for site in all_sites:
            name = site["site_name"]
            if name not in site_avg:
                site_avg[name] = {
                    "q_totals": {f"Q{i}": 0 for i in range(1, 11)},
                    "count": 0
                }
            
            for q, score in site["q_scores"].items():
                site_avg[name]["q_totals"][q] += score
            site_avg[name]["count"] += 1
        
        # í‰ê·  ê³„ì‚° ë° Nielsen ë¶„ì„
        nielsen_reports = []
        
        for site_name, data in site_avg.items():
            avg_scores = {
                q: data["q_totals"][q] / data["count"]
                for q in data["q_totals"]
            }
            
            report = self.analyze_site(site_name, avg_scores)
            nielsen_reports.append(report)
            
            print(f"âœ… {site_name}: {report['overall_score']}/5.0")
        
        # ê²°ê³¼ ì €ì¥
        output_file = self.output_dir / "nielsen_detailed_reports.json"
        with open(output_file, "w", encoding="utf-8") as f:
            json.dump(nielsen_reports, f, ensure_ascii=False, indent=2)
        
        print(f"\nğŸ’¾ Nielsen ìƒì„¸ ë¶„ì„ ì™„ë£Œ!")
        print(f"ğŸ“ ì €ì¥ ìœ„ì¹˜: {output_file}")
        print(f"ğŸ“Š ë¶„ì„ëœ ê¸°ê´€ ìˆ˜: {len(nielsen_reports)}ê°œ")
        
        return nielsen_reports


if __name__ == "__main__":
    analyzer = NielsenAnalyzer()
    reports = analyzer.analyze_all_sites()
    
    # ìƒìœ„ 5ê°œ ê¸°ê´€ ìƒ˜í”Œ ì¶œë ¥
    sorted_reports = sorted(reports, key=lambda x: x["overall_score"], reverse=True)
    
    print("\n" + "="*80)
    print("ğŸ† ìµœê³  ì ìˆ˜ ê¸°ê´€ ìƒ˜í”Œ (Nielsen ìƒì„¸ ë¶„ì„)")
    print("="*80)
    
    for i, report in enumerate(sorted_reports[:5], 1):
        print(f"\n{i}. {report['site_name']}: {report['overall_score']}/5.0")
        print("-" * 80)
        
        # ê° ì›ì¹™ë³„ ì ìˆ˜ í‘œì‹œ
        for principle_code, principle_data in report["principles"].items():
            print(f"\n   {principle_data['name']}: {principle_data['overall_score']}/5.0")
            
            # ê° ì„¸ë¶€ í•­ëª© í‘œì‹œ (ìƒìœ„ 3ê°œë§Œ)
            items = list(principle_data["items"].items())[:3]
            for item_code, item_data in items:
                print(f"      â€¢ {item_data['name']}: {item_data['score']}/5.0")
                print(f"        {item_data['diagnosis']}")
