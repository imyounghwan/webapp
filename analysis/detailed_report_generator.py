#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
AutoAnalyzer - ìƒì„¸ UI/UX ì§„ë‹¨ ë¦¬í¬íŠ¸ ìƒì„±ê¸°
ê° Qí•­ëª©ë³„ë¡œ ì™œ ì´ëŸ° ì ìˆ˜ê°€ ë‚˜ì™”ëŠ”ì§€ êµ¬ì²´ì ìœ¼ë¡œ ë¶„ì„í•˜ê³  ê°œì„  ë°©ì•ˆ ì œì‹œ
"""

import json
from pathlib import Path

class DetailedReportGenerator:
    def __init__(self):
        self.base_dir = Path(__file__).parent
        self.output_dir = self.base_dir / 'output'
        
        # Q1~Q10 ë¶„ì„ ê·œì¹™
        self.analysis_rules = {
            'Q1': {
                'name': 'ëª©ì  ë‹¬ì„±',
                'excellent': {'threshold': 4.5, 'reason': 'ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ ì‰½ê²Œ ì°¾ê³  ì™„ë£Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'details': [
                    'ëª…í™•í•œ CTA(Call-to-Action) ë²„íŠ¼ ë°°ì¹˜',
                    'ì§ê´€ì ì¸ ì„œë¹„ìŠ¤ ë¶„ë¥˜',
                    'ê²€ìƒ‰ ê¸°ëŠ¥ì´ ì˜ ì‘ë™í•¨',
                    'ì‘ì—… ì™„ë£Œê¹Œì§€ 3ë‹¨ê³„ ì´ë‚´'
                ]},
                'good': {'threshold': 4.0, 'reason': 'ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš©ìê°€ ëª©ì ì„ ë‹¬ì„±í•  ìˆ˜ ìˆìœ¼ë‚˜ ì•½ê°„ì˜ ê°œì„  ì—¬ì§€ê°€ ìˆìŠµë‹ˆë‹¤.', 'details': [
                    'ì¼ë¶€ ë©”ë‰´ êµ¬ì¡°ê°€ ë³µì¡í•¨',
                    'ê²€ìƒ‰ ê²°ê³¼ ì •í™•ë„ ê°œì„  í•„ìš”',
                    'ì£¼ìš” ì„œë¹„ìŠ¤ ì ‘ê·¼ì„± í–¥ìƒ í•„ìš”'
                ]},
                'average': {'threshold': 3.5, 'reason': 'ëª©ì  ë‹¬ì„±ì´ ê°€ëŠ¥í•˜ì§€ë§Œ ì‚¬ìš©ìê°€ í—¤ë§¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'details': [
                    'ë©”ë‰´ ê¹Šì´ê°€ 4ë‹¨ê³„ ì´ìƒìœ¼ë¡œ ê¹ŠìŒ',
                    'ì£¼ìš” ì„œë¹„ìŠ¤ê°€ ìˆ¨ê²¨ì ¸ ìˆìŒ',
                    'ê²€ìƒ‰ ê¸°ëŠ¥ì´ ë¶€ì¡±í•˜ê±°ë‚˜ ì—†ìŒ',
                    'ì •ë³´ êµ¬ì¡°ê°€ ë¶ˆëª…í™•í•¨'
                ]},
                'poor': {'threshold': 0, 'reason': 'ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ëª©ì ì„ ë‹¬ì„±í•˜ê¸° ë§¤ìš° ì–´ë µìŠµë‹ˆë‹¤.', 'details': [
                    'ë©”ë‰´ êµ¬ì¡°ê°€ ë§¤ìš° ë³µì¡í•˜ê³  ì§ê´€ì ì´ì§€ ì•ŠìŒ',
                    'ì£¼ìš” ì„œë¹„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ',
                    'ë§í¬ê°€ ëŠì–´ì§€ê±°ë‚˜ ì˜¤ë¥˜ ë°œìƒ',
                    'ì •ë³´ê°€ ë¶„ì‚°ë˜ì–´ ìˆìŒ'
                ]},
                'improvements': [
                    'ìì£¼ ì°¾ëŠ” ì„œë¹„ìŠ¤ë¥¼ ë©”ì¸ í™”ë©´ ìƒë‹¨ì— ë°°ì¹˜',
                    'ë©”ë‰´ êµ¬ì¡°ë¥¼ 2~3ë‹¨ê³„ë¡œ ë‹¨ìˆœí™”',
                    'í†µí•© ê²€ìƒ‰ ê¸°ëŠ¥ ê°•í™”',
                    'ëª…í™•í•œ "ì‹ ì²­í•˜ê¸°", "ì¡°íšŒí•˜ê¸°" ë²„íŠ¼ ì œê³µ'
                ]
            },
            'Q2': {
                'name': 'ì´ìš© í¸ë¦¬ì„±',
                'excellent': {'threshold': 4.5, 'reason': 'ì„œë¹„ìŠ¤ ì´ìš©ì´ ë§¤ìš° í¸ë¦¬í•˜ê³  ì§ê´€ì ì…ë‹ˆë‹¤.', 'details': [
                    'ë¶ˆí•„ìš”í•œ ë‹¨ê³„ê°€ ì—†ìŒ',
                    'ë¡œë”© ì†ë„ê°€ ë¹ ë¦„',
                    'íŒì—…ì´ë‚˜ ê´‘ê³ ê°€ ì—†ìŒ',
                    'ì •ë³´ ë°€ë„ê°€ ì ì ˆí•¨'
                ]},
                'good': {'threshold': 4.0, 'reason': 'ì „ë°˜ì ìœ¼ë¡œ í¸ë¦¬í•˜ë‚˜ ì¼ë¶€ ë¶ˆí¸ ìš”ì†Œê°€ ìˆìŠµë‹ˆë‹¤.', 'details': [
                    'ì¼ë¶€ í˜ì´ì§€ ë¡œë”©ì´ ëŠë¦¼',
                    'íŒì—…ì´ 1~2ê°œ ì¡´ì¬',
                    'ì •ë³´ê°€ ì•½ê°„ ë§ê±°ë‚˜ ì ìŒ'
                ]},
                'average': {'threshold': 3.5, 'reason': 'ì´ìš© ê°€ëŠ¥í•˜ë‚˜ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.', 'details': [
                    'íŒì—…ì´ 3ê°œ ì´ìƒ ëœ¸',
                    'í˜ì´ì§€ ë¡œë”© ì‹œê°„ì´ 3ì´ˆ ì´ìƒ',
                    'ë©”ì¸ í™”ë©´ì— ì •ë³´ê°€ ê³¼ë„í•˜ê²Œ ë§ìŒ',
                    'ë¶ˆí•„ìš”í•œ í´ë¦­ ë‹¨ê³„ê°€ ë§ìŒ'
                ]},
                'poor': {'threshold': 0, 'reason': 'ì„œë¹„ìŠ¤ ì´ìš©ì´ ë§¤ìš° ë¶ˆí¸í•©ë‹ˆë‹¤.', 'details': [
                    'íŒì—…ì´ 5ê°œ ì´ìƒ ì§€ì†ì ìœ¼ë¡œ ëœ¸',
                    'ë¡œë”© ì‹œê°„ì´ 5ì´ˆ ì´ìƒ',
                    'ê´‘ê³ ê°€ í™”ë©´ì„ ê°€ë¦¼',
                    'ëª¨ë°”ì¼ ìµœì í™” ì•ˆ ë¨'
                ]},
                'improvements': [
                    'íŒì—… ìµœì†Œí™” (í•„ìˆ˜ ê³µì§€ë§Œ 1íšŒ í‘œì‹œ)',
                    'ì´ë¯¸ì§€ ìµœì í™”ë¡œ ë¡œë”© ì†ë„ ê°œì„ ',
                    'ë©”ì¸ í™”ë©´ ì •ë³´ 3~5ê°œ ì„¹ì…˜ìœ¼ë¡œ ì œí•œ',
                    'ìë™ ì™„ì„± ê¸°ëŠ¥ ì¶”ê°€'
                ]
            },
            'Q3': {
                'name': 'í•™ìŠµì„±',
                'excellent': {'threshold': 4.5, 'reason': 'ì „ë¬¸ ì§€ì‹ ì—†ì´ë„ ì¦‰ì‹œ ì‚¬ìš©ë²•ì„ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'details': [
                    'ëª…í™•í•˜ê³  ì‰¬ìš´ ìš©ì–´ ì‚¬ìš©',
                    'ì§ê´€ì ì¸ ì•„ì´ì½˜ê³¼ ë ˆì´ë¸”',
                    'íˆ´íŒê³¼ ë„ì›€ë§ ì œê³µ',
                    'ì˜ˆì‹œê°€ ì˜ ì œê³µë¨'
                ]},
                'good': {'threshold': 4.0, 'reason': 'ëŒ€ë¶€ë¶„ ì´í•´í•˜ê¸° ì‰¬ìš°ë‚˜ ì¼ë¶€ ê°œì„  í•„ìš”í•©ë‹ˆë‹¤.', 'details': [
                    'ì¼ë¶€ ì „ë¬¸ ìš©ì–´ ì‚¬ìš©',
                    'ì•„ì´ì½˜ ì˜ë¯¸ê°€ ì•½ê°„ ëª¨í˜¸í•¨',
                    'ë„ì›€ë§ì´ ë¶€ì¡±í•œ ë¶€ë¶„ ìˆìŒ'
                ]},
                'average': {'threshold': 3.5, 'reason': 'ì´í•´í•˜ëŠ” ë° ì‹œê°„ì´ í•„ìš”í•©ë‹ˆë‹¤.', 'details': [
                    'ì „ë¬¸ ìš©ì–´ê°€ ë§ìŒ',
                    'ì•„ì´ì½˜ë§Œ ìˆê³  í…ìŠ¤íŠ¸ ì—†ìŒ',
                    'ë„ì›€ë§ì´ ë¶€ì¡±í•¨',
                    'ì˜ˆì‹œê°€ ì—†ìŒ'
                ]},
                'poor': {'threshold': 0, 'reason': 'ì‚¬ìš©ë²•ì„ ì´í•´í•˜ê¸° ë§¤ìš° ì–´ë µìŠµë‹ˆë‹¤.', 'details': [
                    'ì „ë¬¸ ìš©ì–´ì™€ ì•½ì–´ ë‚¨ìš©',
                    'ì•„ì´ì½˜ ì˜ë¯¸ë¥¼ ì•Œ ìˆ˜ ì—†ìŒ',
                    'ë„ì›€ë§ì´ ì „í˜€ ì—†ìŒ',
                    'ì˜ì–´ë‚˜ ì™¸êµ­ì–´ í˜¼ìš©'
                ]},
                'improvements': [
                    'ì „ë¬¸ ìš©ì–´ë¥¼ ì¼ë°˜ ìš©ì–´ë¡œ ë³€ê²½ ("EDMS" â†’ "ë¬¸ì„œê´€ë¦¬")',
                    'ì•„ì´ì½˜ì— í…ìŠ¤íŠ¸ ë ˆì´ë¸” ì¶”ê°€',
                    'ì²˜ìŒ ë°©ë¬¸ ì‹œ ê°„ë‹¨í•œ íŠœí† ë¦¬ì–¼ ì œê³µ',
                    'ê° ì…ë ¥ í•„ë“œì— ì˜ˆì‹œ í‘œì‹œ'
                ]
            },
            'Q4': {
                'name': 'ë©”ë‰´ ì´ë™',
                'excellent': {'threshold': 4.5, 'reason': 'ì–´ë–¤ í˜ì´ì§€ì—ì„œë“  ì›í•˜ëŠ” ê³³ìœ¼ë¡œ ì‰½ê²Œ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'details': [
                    'ìƒë‹¨ ê³ ì • ë©”ë‰´',
                    'Breadcrumb(í˜„ì¬ ìœ„ì¹˜) í‘œì‹œ',
                    'ë©”ë‰´ 2ë‹¨ê³„ ì´ë‚´',
                    '"í™ˆìœ¼ë¡œ" ë²„íŠ¼ í•­ìƒ í‘œì‹œ'
                ]},
                'good': {'threshold': 4.0, 'reason': 'ëŒ€ë¶€ë¶„ ì´ë™ì´ ì‰¬ìš°ë‚˜ ì¼ë¶€ ê°œì„  í•„ìš”í•©ë‹ˆë‹¤.', 'details': [
                    'ì¼ë¶€ í˜ì´ì§€ì—ì„œ ë©”ë‰´ ì ‘ê·¼ ì–´ë ¤ì›€',
                    'ë©”ë‰´ 3ë‹¨ê³„',
                    'Breadcrumb ì¼ë¶€ ëˆ„ë½'
                ]},
                'average': {'threshold': 3.5, 'reason': 'ì´ë™ ê°€ëŠ¥í•˜ë‚˜ ê¸¸ì„ ìƒê¸° ì‰½ìŠµë‹ˆë‹¤.', 'details': [
                    'ë©”ë‰´ê°€ 4ë‹¨ê³„ ì´ìƒ',
                    'Breadcrumb ì—†ìŒ',
                    'í•˜ìœ„ í˜ì´ì§€ì—ì„œ ë©”ë‰´ ì‚¬ë¼ì§',
                    'ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ì—†ìŒ'
                ]},
                'poor': {'threshold': 0, 'reason': 'í˜ì´ì§€ ê°„ ì´ë™ì´ ë§¤ìš° ì–´ë µìŠµë‹ˆë‹¤.', 'details': [
                    'ë©”ë‰´ êµ¬ì¡°ê°€ ë§¤ìš° ë³µì¡í•¨',
                    'í˜„ì¬ ìœ„ì¹˜ë¥¼ ì•Œ ìˆ˜ ì—†ìŒ',
                    'ë©”ë‰´ê°€ í˜ì´ì§€ë§ˆë‹¤ ë‹¤ë¦„',
                    'í™ˆìœ¼ë¡œ ëŒì•„ê°ˆ ë°©ë²•ì´ ì—†ìŒ'
                ]},
                'improvements': [
                    'ëª¨ë“  í˜ì´ì§€ì— ìƒë‹¨ ê³ ì • ë©”ë‰´ ë°°ì¹˜',
                    'Breadcrumb ì¶”ê°€ (ì˜ˆ: í™ˆ > ë¯¼ì› > ì‹ ì²­)',
                    'ë©”ë‰´ ê¹Šì´ë¥¼ 2~3ë‹¨ê³„ë¡œ ì¶•ì†Œ',
                    'ì‚¬ì´íŠ¸ë§µ ì œê³µ'
                ]
            },
            'Q5': {
                'name': 'ê²½ê³  ë©”ì‹œì§€',
                'excellent': {'threshold': 4.5, 'reason': 'ì˜¤ë¥˜ ë°œìƒ ì‹œ ëª…í™•í•˜ê³  ì¹œì ˆí•œ ì•ˆë‚´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.', 'details': [
                    'ì‹¤ì‹œê°„ ìœ íš¨ì„± ê²€ì‚¬',
                    'êµ¬ì²´ì ì¸ ì˜¤ë¥˜ ë©”ì‹œì§€',
                    'í•´ê²° ë°©ë²• ì œì‹œ',
                    'í•„ìˆ˜ í•­ëª© ëª…í™•íˆ í‘œì‹œ'
                ]},
                'good': {'threshold': 4.0, 'reason': 'ê²½ê³ ëŠ” í‘œì‹œë˜ë‚˜ ë” ëª…í™•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'details': [
                    'ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ì•½ê°„ ëª¨í˜¸í•¨',
                    'ì¼ë¶€ í•„ë“œì—ë§Œ ìœ íš¨ì„± ê²€ì‚¬',
                    'í•´ê²° ë°©ë²•ì´ ëª…í™•í•˜ì§€ ì•ŠìŒ'
                ]},
                'average': {'threshold': 3.5, 'reason': 'ê²½ê³ ê°€ ìˆìœ¼ë‚˜ ì´í•´í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.', 'details': [
                    'ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ì¼ë°˜ì ì„ ("ì˜¤ë¥˜ ë°œìƒ")',
                    'ì–´ëŠ í•„ë“œê°€ ì˜ëª»ë˜ì—ˆëŠ”ì§€ ëª¨í˜¸í•¨',
                    'í•„ìˆ˜ í•­ëª© í‘œì‹œ ë¶€ì¡±',
                    'ì œì¶œ í›„ì—ë§Œ ì˜¤ë¥˜ í™•ì¸ ê°€ëŠ¥'
                ]},
                'poor': {'threshold': 0, 'reason': 'ê²½ê³  ë©”ì‹œì§€ê°€ ì—†ê±°ë‚˜ ë§¤ìš° ë¶ˆì¹œì ˆí•©ë‹ˆë‹¤.', 'details': [
                    'ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ì „í˜€ ì—†ìŒ',
                    'ì˜ëª» ì…ë ¥í•´ë„ ì•Œ ìˆ˜ ì—†ìŒ',
                    'ì˜ì–´ë‚˜ ì½”ë“œë¡œ í‘œì‹œë¨',
                    'ì—ëŸ¬ ì½”ë“œë§Œ í‘œì‹œ'
                ]},
                'improvements': [
                    'ì‹¤ì‹œê°„ ì…ë ¥ ê²€ì¦ ì¶”ê°€',
                    'êµ¬ì²´ì ì¸ ë©”ì‹œì§€ ("ì´ë©”ì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ì˜ˆ: abc@example.com")',
                    'í•„ìˆ˜ í•­ëª©ì— * í‘œì‹œ',
                    'ì˜¤ë¥˜ í•„ë“œì— ë¹¨ê°„ìƒ‰ í…Œë‘ë¦¬'
                ]
            },
            'Q6': {
                'name': 'ì¹œì ˆí•œ ì„¤ëª…',
                'excellent': {'threshold': 4.5, 'reason': 'ì„œë¹„ìŠ¤ ì´ìš© ë°©ë²•ì´ ë§¤ìš° ì¹œì ˆí•˜ê³  ìƒì„¸í•˜ê²Œ ì„¤ëª…ë˜ì–´ ìˆìŠµë‹ˆë‹¤.', 'details': [
                    'ë‹¨ê³„ë³„ ì•ˆë‚´',
                    'FAQ ì œê³µ',
                    'ì˜ˆì‹œì™€ ìƒ˜í”Œ ì œê³µ',
                    'ë™ì˜ìƒ ê°€ì´ë“œ'
                ]},
                'good': {'threshold': 4.0, 'reason': 'ê¸°ë³¸ì ì¸ ì„¤ëª…ì€ ì œê³µë˜ë‚˜ ë” ìƒì„¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'details': [
                    'FAQê°€ ìˆìœ¼ë‚˜ ë‚´ìš© ë¶€ì¡±',
                    'ì˜ˆì‹œê°€ ì¼ë¶€ë§Œ ìˆìŒ',
                    'ì„¤ëª…ì´ ì•½ê°„ ë¶€ì¡±í•¨'
                ]},
                'average': {'threshold': 3.5, 'reason': 'ìµœì†Œí•œì˜ ì„¤ëª…ë§Œ ì œê³µë©ë‹ˆë‹¤.', 'details': [
                    'ì„¤ëª…ì´ ë§¤ìš° ê°„ëµí•¨',
                    'FAQ ì—†ìŒ',
                    'ì˜ˆì‹œ ì—†ìŒ',
                    'ë„ì›€ë§ ë²„íŠ¼ë§Œ ìˆìŒ'
                ]},
                'poor': {'threshold': 0, 'reason': 'ì„¤ëª…ì´ ê±°ì˜ ì—†ê±°ë‚˜ ì „í˜€ ì—†ìŠµë‹ˆë‹¤.', 'details': [
                    'ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ ì „í˜€ ëª¨ë¦„',
                    'ì…ë ¥ í¼ë§Œ ìˆìŒ',
                    'ë„ì›€ë§ ë§í¬ ì—†ìŒ',
                    'ì „í™” ë¬¸ì˜ë§Œ ì•ˆë‚´'
                ]},
                'improvements': [
                    'ë‹¨ê³„ë³„ ê°€ì´ë“œ ì¶”ê°€ ("â‘  ì •ë³´ ì…ë ¥ â†’ â‘¡ ì„œë¥˜ ì²¨ë¶€ â†’ â‘¢ ì œì¶œ")',
                    'FAQ ì„¹ì…˜ ì‘ì„± (ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ TOP 10)',
                    'ì…ë ¥ ì˜ˆì‹œ ì œê³µ',
                    'ì±„íŒ… ìƒë‹´ ë˜ëŠ” ì±—ë´‡ ì¶”ê°€'
                ]
            },
            'Q7': {
                'name': 'ì‹œê°ì  êµ¬ë¶„',
                'excellent': {'threshold': 4.5, 'reason': 'ì •ë³´ê°€ ì‹œê°ì ìœ¼ë¡œ ëª…í™•í•˜ê²Œ êµ¬ë¶„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.', 'details': [
                    'ì œëª©ê³¼ ë³¸ë¬¸ì´ ëª…í™•íˆ êµ¬ë¶„ë¨',
                    'ì ì ˆí•œ ì—¬ë°± ì‚¬ìš©',
                    'ì„¹ì…˜ë³„ êµ¬ë¶„ì„ /ë°•ìŠ¤',
                    'ì¤‘ìš” ì •ë³´ ê°•ì¡°'
                ]},
                'good': {'threshold': 4.0, 'reason': 'ëŒ€ì²´ë¡œ ì˜ êµ¬ë¶„ë˜ë‚˜ ì¼ë¶€ ê°œì„  í•„ìš”í•©ë‹ˆë‹¤.', 'details': [
                    'ì¼ë¶€ ì„¹ì…˜ êµ¬ë¶„ ëª¨í˜¸',
                    'ì—¬ë°±ì´ ì•½ê°„ ì¢ìŒ',
                    'ê°•ì¡°ê°€ ë¶€ì¡±í•œ ë¶€ë¶„ ìˆìŒ'
                ]},
                'average': {'threshold': 3.5, 'reason': 'ì •ë³´ êµ¬ë¶„ì´ ëª…í™•í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'details': [
                    'ëª¨ë“  í…ìŠ¤íŠ¸ê°€ ê°™ì€ í¬ê¸°',
                    'ì—¬ë°±ì´ ê±°ì˜ ì—†ìŒ',
                    'êµ¬ë¶„ì„ ì´ ì—†ìŒ',
                    'ì •ë³´ê°€ ë­‰ì³ ìˆìŒ'
                ]},
                'poor': {'threshold': 0, 'reason': 'ì‹œê°ì ìœ¼ë¡œ ë§¤ìš° í˜¼ë€ìŠ¤ëŸ½ìŠµë‹ˆë‹¤.', 'details': [
                    'ì œëª©ê³¼ ë³¸ë¬¸ì„ êµ¬ë¶„í•  ìˆ˜ ì—†ìŒ',
                    'ì •ë³´ê°€ í•œ ë©ì–´ë¦¬ë¡œ í‘œì‹œë¨',
                    'ì—¬ë°±ì´ ì „í˜€ ì—†ìŒ',
                    'ìƒ‰ìƒê³¼ í¬ê¸°ê°€ ëª¨ë‘ ê°™ìŒ'
                ]},
                'improvements': [
                    'ì œëª© í°íŠ¸ í¬ê¸° 2ë°° ì¦ê°€',
                    'ì„¹ì…˜ë³„ ë°•ìŠ¤ ë˜ëŠ” ë°°ê²½ìƒ‰ ì ìš©',
                    'ì—¬ë°±ì„ 20~30pxë¡œ í™•ëŒ€',
                    'ì¤‘ìš” ì •ë³´ëŠ” êµµê²Œ ë˜ëŠ” ìƒ‰ìƒìœ¼ë¡œ ê°•ì¡°'
                ]
            },
            'Q8': {
                'name': 'ì¼ê´€ì„±',
                'excellent': {'threshold': 4.5, 'reason': 'ëª¨ë“  í˜ì´ì§€ì—ì„œ ë””ìì¸ì´ ì¼ê´€ì ì…ë‹ˆë‹¤.', 'details': [
                    'í°íŠ¸ 1~2ê°œ ì‚¬ìš©',
                    'ìƒ‰ìƒ 3~4ê°€ì§€ë¡œ ì œí•œ',
                    'ë²„íŠ¼ ìŠ¤íƒ€ì¼ í†µì¼',
                    'ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ ì¼ê´€'
                ]},
                'good': {'threshold': 4.0, 'reason': 'ëŒ€ì²´ë¡œ ì¼ê´€ì ì´ë‚˜ ì¼ë¶€ ë¶ˆì¼ì¹˜ ìˆìŠµë‹ˆë‹¤.', 'details': [
                    'ì¼ë¶€ í˜ì´ì§€ì—ì„œ í°íŠ¸ ë‹¤ë¦„',
                    'ìƒ‰ìƒì´ 5~6ê°€ì§€',
                    'ë²„íŠ¼ ìŠ¤íƒ€ì¼ì´ ì•½ê°„ ë‹¤ë¦„'
                ]},
                'average': {'threshold': 3.5, 'reason': 'ì¼ê´€ì„±ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.', 'details': [
                    'í˜ì´ì§€ë§ˆë‹¤ ë‹¤ë¥¸ í°íŠ¸',
                    'ìƒ‰ìƒì´ 7ê°€ì§€ ì´ìƒ',
                    'ë²„íŠ¼ ìŠ¤íƒ€ì¼ì´ ì œê°ê°',
                    'ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ í˜¼ì¬'
                ]},
                'poor': {'threshold': 0, 'reason': 'ì¼ê´€ì„±ì´ ì „í˜€ ì—†ìŠµë‹ˆë‹¤.', 'details': [
                    'ëª¨ë“  í˜ì´ì§€ê°€ ë‹¤ë¥¸ ë””ìì¸',
                    'í°íŠ¸ì™€ ìƒ‰ìƒì´ ë¬´ì‘ìœ„',
                    'ê°™ì€ ê¸°ëŠ¥ì˜ ë²„íŠ¼ë„ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼',
                    'í†µì¼ì„± ì—†ìŒ'
                ]},
                'improvements': [
                    'ë””ìì¸ ì‹œìŠ¤í…œ êµ¬ì¶• (í°íŠ¸, ìƒ‰ìƒ, ì»´í¬ë„ŒíŠ¸)',
                    'ê¸°ë³¸ í°íŠ¸ 1ê°œë¡œ í†µì¼',
                    'ë¸Œëœë“œ ìƒ‰ìƒ 3ê°€ì§€ë§Œ ì‚¬ìš©',
                    'ë²„íŠ¼ ì»´í¬ë„ŒíŠ¸ í†µì¼'
                ]
            },
            'Q9': {
                'name': 'ë³´í¸ì„±',
                'excellent': {'threshold': 4.5, 'reason': 'ìµìˆ™í•˜ê³  ë³´í¸ì ì¸ ì›¹ íŒ¨í„´ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.', 'details': [
                    'ë¡œê³ ëŠ” ì™¼ìª½ ìƒë‹¨',
                    'ë©”ë‰´ëŠ” ìƒë‹¨ ë˜ëŠ” ì¢Œì¸¡',
                    'ê²€ìƒ‰ì€ ì˜¤ë¥¸ìª½ ìƒë‹¨',
                    'ìµìˆ™í•œ ì•„ì´ì½˜ ì‚¬ìš©'
                ]},
                'good': {'threshold': 4.0, 'reason': 'ëŒ€ì²´ë¡œ ë³´í¸ì ì´ë‚˜ ì¼ë¶€ ë‚¯ì„  ìš”ì†Œ ìˆìŠµë‹ˆë‹¤.', 'details': [
                    'ì¼ë¶€ ë°°ì¹˜ê°€ ë¹„í‘œì¤€',
                    'ìµìˆ™í•˜ì§€ ì•Šì€ ì•„ì´ì½˜ ì‚¬ìš©',
                    'ì¼ë¶€ UI íŒ¨í„´ì´ ë…íŠ¹í•¨'
                ]},
                'average': {'threshold': 3.5, 'reason': 'ë‚¯ì„  êµ¬ì¡°ë¡œ ì‚¬ìš©ìê°€ í˜¼ë€ìŠ¤ëŸ¬ì›Œí•©ë‹ˆë‹¤.', 'details': [
                    'ë…íŠ¹í•œ ë ˆì´ì•„ì›ƒ',
                    'ë¹„í‘œì¤€ ìœ„ì¹˜ì— ìš”ì†Œ ë°°ì¹˜',
                    'ìµìˆ™í•˜ì§€ ì•Šì€ ì¸í„°ë™ì…˜',
                    'ì˜ˆìƒê³¼ ë‹¤ë¥¸ ë™ì‘'
                ]},
                'poor': {'threshold': 0, 'reason': 'ë§¤ìš° ìƒì†Œí•˜ê³  í˜¼ë€ìŠ¤ëŸ¬ìš´ êµ¬ì¡°ì…ë‹ˆë‹¤.', 'details': [
                    'ì™„ì „íˆ ë…ì°½ì ì¸ ë ˆì´ì•„ì›ƒ',
                    'ì¼ë°˜ì ì¸ íŒ¨í„´ì„ ì „í˜€ ë”°ë¥´ì§€ ì•ŠìŒ',
                    'ì‚¬ìš©ìê°€ ì™„ì „íˆ í˜¼ë€ìŠ¤ëŸ¬ì›Œí•¨'
                ]},
                'improvements': [
                    'ë¡œê³ ë¥¼ ì™¼ìª½ ìƒë‹¨ìœ¼ë¡œ ì´ë™',
                    'ë©”ë‰´ë¥¼ ìƒë‹¨ ê°€ë¡œ ë°°ì¹˜ë¡œ ë³€ê²½',
                    'ê²€ìƒ‰ ì•„ì´ì½˜ì„ ì˜¤ë¥¸ìª½ ìƒë‹¨ì— ë°°ì¹˜',
                    'í‘œì¤€ UI ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©'
                ]
            },
            'Q10': {
                'name': 'ìƒ‰ìƒ ì¡°í™”',
                'excellent': {'threshold': 4.5, 'reason': 'ìƒ‰ìƒì´ ë§¤ìš° ì¡°í™”ë¡­ê³  ë³´ê¸° í¸ì•ˆí•©ë‹ˆë‹¤.', 'details': [
                    'ìƒ‰ìƒ 2~3ê°€ì§€ ì¡°í•©',
                    'ëª…ë„ ëŒ€ë¹„ ì¶©ë¶„',
                    'ë¸Œëœë“œ ìƒ‰ìƒ ì¼ê´€ì ',
                    'ëˆˆì— í¸ì•ˆí•¨'
                ]},
                'good': {'threshold': 4.0, 'reason': 'ìƒ‰ìƒì´ ì¡°í™”ë¡­ì§€ë§Œ ì•½ê°„ ê°œì„  ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'details': [
                    'ìƒ‰ìƒì´ 4~5ê°€ì§€',
                    'ì¼ë¶€ ëª…ë„ ëŒ€ë¹„ ë¶€ì¡±',
                    'ì•½ê°„ ëˆˆì— í”¼ë¡œí•¨'
                ]},
                'average': {'threshold': 3.5, 'reason': 'ìƒ‰ìƒ ì¡°í™”ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.', 'details': [
                    'ìƒ‰ìƒì´ 6ê°€ì§€ ì´ìƒ',
                    'ëª…ë„ ëŒ€ë¹„ ë¶ˆì¶©ë¶„',
                    'ì½ê¸° ì–´ë ¤ì›€',
                    'ëˆˆì´ í”¼ë¡œí•¨'
                ]},
                'poor': {'threshold': 0, 'reason': 'ìƒ‰ìƒì´ ë§¤ìš° ë¶ˆí¸í•˜ê³  ê°€ë…ì„±ì´ ë–¨ì–´ì§‘ë‹ˆë‹¤.', 'details': [
                    'ì›ìƒ‰ ë‚¨ìš©',
                    'ë°°ê²½ê³¼ í…ìŠ¤íŠ¸ ëŒ€ë¹„ ì—†ìŒ',
                    'ìƒ‰ìƒì´ ë¬´ì‘ìœ„ë¡œ ì‚¬ìš©ë¨',
                    'ë§¤ìš° ëˆˆì´ í”¼ë¡œí•¨'
                ]},
                'improvements': [
                    'ë¸Œëœë“œ ìƒ‰ìƒ 1ê°œ + ë³´ì¡° ìƒ‰ìƒ 2ê°œë¡œ ì œí•œ',
                    'í…ìŠ¤íŠ¸ ëª…ë„ ëŒ€ë¹„ìœ¨ 4.5:1 ì´ìƒ í™•ë³´',
                    'íšŒìƒ‰ ê³„ì—´ì„ ì£¼ë¡œ ì‚¬ìš©í•˜ê³  ê°•ì¡°ìƒ‰ë§Œ ì¶”ê°€',
                    'ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ê°€ì´ë“œ ì‘ì„±'
                ]
            }
        }
    
    def get_level(self, score, rules):
        """ì ìˆ˜ì— ë”°ë¥¸ ë ˆë²¨ ê²°ì •"""
        if score >= rules['excellent']['threshold']:
            return 'excellent', rules['excellent']
        elif score >= rules['good']['threshold']:
            return 'good', rules['good']
        elif score >= rules['average']['threshold']:
            return 'average', rules['average']
        else:
            return 'poor', rules['poor']
    
    def calculate_improvement_impact(self, score, target=4.5):
        """ê°œì„  ì‹œ ì˜ˆìƒ ì ìˆ˜ í–¥ìƒ"""
        if score >= target:
            return 0, "ì´ë¯¸ ìš°ìˆ˜í•œ ìˆ˜ì¤€ì…ë‹ˆë‹¤"
        
        gap = target - score
        if gap <= 0.3:
            return gap, "ì†Œí­ ê°œì„ "
        elif gap <= 0.5:
            return gap, "ì¤‘ê°„ ê°œì„ "
        else:
            return gap, "ëŒ€í­ ê°œì„ "
    
    def generate_detailed_report(self, site_data):
        """ê¸°ê´€ë³„ ìƒì„¸ ë¦¬í¬íŠ¸ ìƒì„±"""
        site_name = site_data['name']
        scores = site_data['scores']
        
        print(f"\n{'='*60}")
        print(f"ğŸ¢ {site_name} - ìƒì„¸ UI/UX ì§„ë‹¨ ë¦¬í¬íŠ¸")
        print(f"{'='*60}\n")
        
        report = {
            'site_name': site_name,
            'url': site_data.get('url', ''),
            'total_score': site_data['total_avg'],
            'convenience_score': site_data['convenience_avg'],
            'design_score': site_data['design_avg'],
            'detailed_analysis': {},
            'priority_improvements': [],
            'overall_summary': ''
        }
        
        # Q1~Q10 ìƒì„¸ ë¶„ì„
        low_scores = []
        
        for q_num in range(1, 11):
            q_key = f'Q{q_num}'
            score = scores.get(q_key, 0)
            rules = self.analysis_rules[q_key]
            
            level, level_info = self.get_level(score, rules)
            improvement_gap, improvement_level = self.calculate_improvement_impact(score)
            
            analysis = {
                'item': rules['name'],
                'score': score,
                'level': level,
                'reason': level_info['reason'],
                'details': level_info['details'],
                'improvements': rules['improvements'],
                'improvement_gap': round(improvement_gap, 2),
                'improvement_level': improvement_level
            }
            
            report['detailed_analysis'][q_key] = analysis
            
            # ì ìˆ˜ê°€ ë‚®ì€ í•­ëª© ì¶”ì 
            if score < 4.0:
                low_scores.append((q_key, score, rules['name'], improvement_gap))
            
            # ì¶œë ¥
            print(f"ğŸ“Š {q_key}. {rules['name']}: {score:.2f}ì ")
            print(f"   ë ˆë²¨: {level.upper()}")
            print(f"   ë¶„ì„: {level_info['reason']}")
            print(f"   ìƒì„¸:")
            for detail in level_info['details'][:3]:  # ìƒìœ„ 3ê°œë§Œ
                print(f"      â€¢ {detail}")
            
            if improvement_gap > 0:
                print(f"   ê°œì„  ì—¬ì§€: +{improvement_gap:.2f}ì  ({improvement_level})")
                print(f"   ê°œì„  ë°©ì•ˆ:")
                for imp in rules['improvements'][:2]:  # ìƒìœ„ 2ê°œë§Œ
                    print(f"      âœ“ {imp}")
            print()
        
        # ìš°ì„ ìˆœìœ„ ê°œì„  í•­ëª© (ì ìˆ˜ ë‚®ì€ ìˆœ)
        low_scores.sort(key=lambda x: x[1])
        
        print(f"\n{'='*60}")
        print("ğŸ¯ ìš°ì„ ìˆœìœ„ ê°œì„  í•­ëª© (ì ìˆ˜ ë‚®ì€ ìˆœ)")
        print(f"{'='*60}\n")
        
        for i, (q_key, score, name, gap) in enumerate(low_scores[:5], 1):
            rules = self.analysis_rules[q_key]
            print(f"{i}. {name} ({score:.2f}ì )")
            print(f"   í˜„ì¬ ë¬¸ì œ:")
            _, level_info = self.get_level(score, rules)
            for detail in level_info['details'][:2]:
                print(f"      âŒ {detail}")
            print(f"   ê°œì„  ë°©ì•ˆ:")
            for imp in rules['improvements'][:2]:
                print(f"      âœ… {imp}")
            print(f"   ì˜ˆìƒ íš¨ê³¼: +{gap:.2f}ì  í–¥ìƒ\n")
            
            report['priority_improvements'].append({
                'rank': i,
                'item': name,
                'q_key': q_key,
                'current_score': score,
                'problems': level_info['details'][:2],
                'solutions': rules['improvements'][:2],
                'expected_gain': round(gap, 2)
            })
        
        # ì¢…í•© í‰ê°€
        if site_data['total_avg'] >= 4.5:
            summary = "ìš°ìˆ˜í•œ UI/UX ìˆ˜ì¤€ì…ë‹ˆë‹¤. ì†Œí­ ê°œì„ ë§Œìœ¼ë¡œë„ ì™„ë²½ì— ê°€ê¹Œì›Œì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        elif site_data['total_avg'] >= 4.0:
            summary = "ì–‘í˜¸í•œ ìˆ˜ì¤€ì´ë‚˜ ëª‡ ê°€ì§€ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤. ìš°ì„ ìˆœìœ„ í•­ëª©ë¶€í„° ê°œì„ í•˜ë©´ 4.5ì  ì´ìƒ ë‹¬ì„± ê°€ëŠ¥í•©ë‹ˆë‹¤."
        elif site_data['total_avg'] >= 3.5:
            summary = "ë³´í†µ ìˆ˜ì¤€ìœ¼ë¡œ ìƒë‹¹í•œ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤. ì²´ê³„ì ì¸ ê°œì„  ê³„íšì„ ìˆ˜ë¦½í•´ì•¼ í•©ë‹ˆë‹¤."
        else:
            summary = "ë§ì€ ê°œì„ ì´ í•„ìš”í•œ ìƒíƒœì…ë‹ˆë‹¤. ì „ì²´ì ì¸ UI/UX ì¬ì„¤ê³„ë¥¼ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤."
        
        report['overall_summary'] = summary
        
        print(f"{'='*60}")
        print("ğŸ“ ì¢…í•© í‰ê°€")
        print(f"{'='*60}\n")
        print(summary)
        print()
        
        return report
    
    def generate_all_reports(self):
        """ëª¨ë“  ê¸°ê´€ ë¦¬í¬íŠ¸ ìƒì„±"""
        # site_averages.json ë¡œë“œ
        input_file = self.output_dir / 'site_averages.json'
        
        if not input_file.exists():
            print(f"âŒ {input_file} íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
            return
        
        with open(input_file, 'r', encoding='utf-8') as f:
            sites = json.load(f)
        
        all_reports = []
        
        # ìµœì €ì  5ê³³ë§Œ ìƒì„¸ ë¦¬í¬íŠ¸ ìƒì„± (ì˜ˆì‹œ)
        bottom_5 = sorted(sites, key=lambda x: x['total_avg'])[:5]
        
        for site in bottom_5:
            report = self.generate_detailed_report(site)
            all_reports.append(report)
        
        # JSON ì €ì¥
        output_file = self.output_dir / 'detailed_reports.json'
        with open(output_file, 'w', encoding='utf-8') as f:
            json.dump(all_reports, f, ensure_ascii=False, indent=2)
        
        print(f"\nğŸ’¾ ìƒì„¸ ë¦¬í¬íŠ¸ ì €ì¥: {output_file}")
        print(f"âœ… {len(all_reports)}ê°œ ê¸°ê´€ ìƒì„¸ ë¶„ì„ ì™„ë£Œ")

def main():
    generator = DetailedReportGenerator()
    generator.generate_all_reports()

if __name__ == '__main__':
    main()
